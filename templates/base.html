<!DOCTYPE html>
<html lang="ja" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}SONAR{% endblock %} - Semiconductor Analytics</title>
    <meta name="description" content="Semiconductor Analytics Platform for Yield, SPC, and Wafer Map visualization">
    
    <!-- HTMX -->
    <script src="https://unpkg.com/htmx.org@2.0.4"></script>
    
    <!-- Plotly.js CDN (for interactive charts) -->
    <script src="https://cdn.plot.ly/plotly-2.35.2.min.js" charset="utf-8"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.min.js"></script>
    
    <link rel="stylesheet" href="/static/css/style.css">
    {% block head %}{% endblock %}
</head>
<body>
    <div class="app-container">
        {% include "components/sidebar.html" %}
        
        <main class="main-content">
            {% include "components/header.html" %}
            
            <div class="dashboard-content">
                {% block content %}{% endblock %}
            </div>
        </main>
    </div>
    
    <script>
        // Initialize Lucide icons
        lucide.createIcons();
        
        // Theme management
        function getTheme() {
            return document.cookie.split('; ')
                .find(row => row.startsWith('theme='))
                ?.split('=')[1] || 'dark';
        }
        
        function setTheme(theme) {
            document.documentElement.setAttribute('data-theme', theme);
            document.cookie = `theme=${theme};path=/;max-age=31536000`;
        }
        
        function toggleTheme() {
            const current = getTheme();
            setTheme(current === 'dark' ? 'light' : 'dark');
            lucide.createIcons();
        }
        
        // Apply saved theme on load
        setTheme(getTheme());
        
        // Re-initialize icons after HTMX swaps
        document.body.addEventListener('htmx:afterSwap', function() {
            lucide.createIcons();
        });
    </script>
    {% block scripts %}{% endblock %}
</body>
</html>
